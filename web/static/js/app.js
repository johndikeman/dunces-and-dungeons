// Generated by CoffeeScript 1.10.0
(function() {
  var is_choice, make_choice_form, process_output;

  $(document).ready(function() {
    process_output(window.messages);
    return console.log("new print " + window.messages);
  });

  is_choice = function(data) {
    if (data.slice(0, 6) === 'CHOICE') {
      return true;
    }
    return false;
  };

  make_choice_form = function(data) {
    var a, form, i, len, options;
    console.log(window.choiceskips);
    if (window.choiceskips === 0) {
      options = data.slice(6).split('|');
      form = "<form id=\"ch\" action=\"/choice\" method='post'>";
      for (i = 0, len = options.length; i < len; i++) {
        a = options[i];
        if (a !== '' && a !== void 0) {
          form += "<input type=\"radio\" name='makechoice' value=\"" + data + "%" + a[0] + "\">" + a.slice(1) + "<br>";
        }
      }
      form += "<input type=\"submit\" value=\"choose!\">";
      form += "</form>";
      return $('#choiceholder').append(form);
    } else {
      return window.choiceskips -= 1;
    }
  };

  process_output = function(message) {
    var i, len, mes, results;
    results = [];
    for (i = 0, len = message.length; i < len; i++) {
      mes = message[i];
      if (is_choice(mes)) {
        results.push(make_choice_form(mes));
      } else {
        results.push($('#main').append(mes + "<br>"));
      }
    }
    return results;
  };

}).call(this);
